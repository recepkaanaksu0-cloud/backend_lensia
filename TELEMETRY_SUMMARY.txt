â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  TELEMETRÄ° VE HEALTH CHECK SÄ°STEMÄ° EKLENDÄ°! 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š YENÄ° ENDPOINT'LER

1. GET /api/ping
   â”œâ”€ Basit canlÄ±lÄ±k kontrolÃ¼
   â”œâ”€ Kimlik doÄŸrulama YOK
   â”œâ”€ HÄ±z: <10ms
   â””â”€ KullanÄ±m: Uptime monitoring

2. GET /api/health
   â”œâ”€ DetaylÄ± sistem durumu
   â”œâ”€ Kimlik doÄŸrulama YOK
   â”œâ”€ HÄ±z: <100ms
   â”œâ”€ Servisler: Database, ComfyUI, Webhook
   â”œâ”€ Ä°statistikler: Jobs, Queue, Performance
   â””â”€ KullanÄ±m: Health monitoring, Alerting

3. GET /api/telemetry
   â”œâ”€ KapsamlÄ± metrikler
   â”œâ”€ Kimlik doÄŸrulama GEREKLÄ° (X-API-Key)
   â”œâ”€ HÄ±z: <200ms
   â”œâ”€ Metrikler: DetaylÄ± iÅŸ istatistikleri
   â”œâ”€ Timeline: 1h, 24h, 7d
   â””â”€ KullanÄ±m: Analytics, BI, Monitoring

4. POST /api/telemetry
   â”œâ”€ Lensia.ai â†’ Dashboard veri gÃ¶nderimi
   â”œâ”€ Kimlik doÄŸrulama GEREKLÄ°
   â””â”€ KullanÄ±m: Ä°ki yÃ¶nlÃ¼ telemetri

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  LENSIA.AI Ä°Ã‡Ä°N KULLANIM Ã–RNEKLERÄ°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Basit Ping (Her 1 dakika)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

fetch('https://api.lensia.ai/api/ping')
  .then(res => res.json())
  .then(data => {
    if (data.status !== 'ok') {
      sendAlert('Dashboard down!')
    }
  })

Response:
{
  "status": "ok",
  "message": "pong",
  "timestamp": "2025-10-03T12:00:00.000Z"
}


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Health Check (Her 5 dakika)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

fetch('https://api.lensia.ai/api/health')
  .then(res => res.json())
  .then(health => {
    console.log('Status:', health.status)  // "healthy" | "degraded"
    console.log('ComfyUI:', health.services.comfyui.status)
    console.log('Queue:', health.statistics.pending)
    
    if (health.status === 'degraded') {
      sendAlert('Dashboard degraded!')
    }
  })

Response:
{
  "status": "healthy",
  "services": {
    "database": { "status": "up" },
    "comfyui": { "status": "up" },
    "webhook": { "status": "up" }
  },
  "statistics": {
    "total": 150,
    "pending": 5,
    "completed": 140,
    "queueHealth": "good"
  }
}


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. DetaylÄ± Telemetri (Her 15 dakika)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

fetch('https://api.lensia.ai/api/telemetry', {
  headers: {
    'X-API-Key': 'your-api-key-here'
  }
})
  .then(res => res.json())
  .then(telemetry => {
    console.log('Jobs Total:', telemetry.jobs.total)
    console.log('Success Rate:', telemetry.jobs.performance.successRate)
    console.log('Avg Time:', telemetry.jobs.performance.averageProcessingTime)
    console.log('Webhook Success:', telemetry.webhooks.successRate)
  })

Response:
{
  "jobs": {
    "total": 1500,
    "byStatus": {
      "pending": 5,
      "processing": 2,
      "completed": 1200
    },
    "timeline": {
      "lastHour": 12,
      "last24Hours": 250
    },
    "performance": {
      "averageProcessingTime": "2m",
      "successRate": "96%"
    }
  },
  "webhooks": {
    "successRate": "96%"
  }
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  MONITORING VE ALERTING Ã–NERÄ°LERÄ°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Metrik                                â”‚ Alert KoÅŸulu        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dashboard Status                      â”‚ status != "healthy" â”‚
â”‚ ComfyUI Status                        â”‚ status == "down"    â”‚
â”‚ Queue Size                            â”‚ > 50 jobs           â”‚
â”‚ Queue Health                          â”‚ "high"              â”‚
â”‚ Success Rate                          â”‚ < 90%               â”‚
â”‚ Webhook Success Rate                  â”‚ < 95%               â”‚
â”‚ Response Time                         â”‚ > 1000ms            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ã–rnek Alert Logic:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const health = await fetch('https://api.lensia.ai/api/health')
const data = await health.json()

// Critical Alerts
if (data.status === 'degraded') {
  sendSlackAlert('ğŸš¨ Dashboard degraded!')
}

if (data.services.comfyui.status === 'down') {
  sendSlackAlert('âš ï¸ ComfyUI is DOWN!')
  // Auto-restart script Ã§alÄ±ÅŸtÄ±r
}

// Warning Alerts
if (data.statistics.queueHealth === 'high') {
  sendSlackAlert(`ğŸ“Š High queue: ${data.statistics.pending} jobs`)
}

if (data.statistics.pending > 100) {
  sendSlackAlert('ğŸ”´ Queue overflow! Consider scaling.')
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  TELEGRAM BOT Ã–RNEÄÄ°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const TelegramBot = require('node-telegram-bot-api')
const bot = new TelegramBot(TELEGRAM_TOKEN)

async function monitorDashboard() {
  const res = await fetch('https://api.lensia.ai/api/health')
  const health = await res.json()
  
  if (health.status === 'degraded') {
    await bot.sendMessage(
      ADMIN_CHAT_ID,
      `âš ï¸ Dashboard Degraded!\n\n` +
      `ComfyUI: ${health.services.comfyui.status}\n` +
      `Queue: ${health.statistics.pending} jobs`
    )
  }
}

setInterval(monitorDashboard, 120000) // Her 2 dakika

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PROMETHEUS METRICS EXPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Express.js endpoint
app.get('/metrics', async (req, res) => {
  const telemetry = await fetch('https://api.lensia.ai/api/telemetry', {
    headers: { 'X-API-Key': API_KEY }
  })
  const data = await telemetry.json()
  
  const metrics = `
dashboard_jobs_total ${data.jobs.total}
dashboard_jobs_pending ${data.jobs.byStatus.pending}
dashboard_jobs_completed ${data.jobs.byStatus.completed}
dashboard_queue_health ${data.queue.health === 'healthy' ? 0 : 1}
dashboard_webhook_success_rate ${parseFloat(data.webhooks.successRate) / 100}
  `.trim()
  
  res.set('Content-Type', 'text/plain')
  res.send(metrics)
})

// Prometheus scrape config:
scrape_configs:
  - job_name: 'dashboard'
    scrape_interval: 15m
    static_configs:
      - targets: ['lensia.ai:9090']

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  GRAFANA DASHBOARD Ã–RNEÄÄ°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Panel 1: Dashboard Status
  â”œâ”€ Query: up{job="dashboard"}
  â”œâ”€ Type: Stat
  â””â”€ Color: Green (up) / Red (down)

Panel 2: Queue Size
  â”œâ”€ Query: dashboard_jobs_pending
  â”œâ”€ Type: Graph
  â””â”€ Thresholds:
      â”œâ”€ 0-10: Green
      â”œâ”€ 10-50: Yellow
      â””â”€ 50+: Red

Panel 3: Success Rate
  â”œâ”€ Query: dashboard_webhook_success_rate * 100
  â”œâ”€ Type: Gauge
  â””â”€ Min: 0%, Max: 100%, Target: 95%

Panel 4: Processing Time
  â”œâ”€ Query: dashboard_avg_processing_time
  â”œâ”€ Type: Graph
  â””â”€ Unit: seconds

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  TEST KOMUTLARI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ping test
curl https://api.lensia.ai/api/ping

# Health check test
curl https://api.lensia.ai/api/health | jq

# Telemetry test (API key gerekli)
curl https://api.lensia.ai/api/telemetry \
  -H "X-API-Key: your-api-key" | jq

# POST telemetry test
curl -X POST https://api.lensia.ai/api/telemetry \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "source": "lensia-main-site",
    "metrics": {
      "activeUsers": 1250,
      "jobsSubmitted": 250
    }
  }'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Ã–NERÄ°LEN Ä°STEK SIKLIÄI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Endpoint         â”‚ Ã–nerilen        â”‚ Max SÄ±klÄ±k          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /api/ping        â”‚ 1 dakika        â”‚ 10 saniye           â”‚
â”‚ /api/health      â”‚ 5 dakika        â”‚ 1 dakika            â”‚
â”‚ /api/telemetry   â”‚ 15 dakika       â”‚ 5 dakika            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  OLUÅTURULAN DOSYALAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… app/api/ping/route.ts               - Basit ping endpoint
âœ… app/api/health/route.ts             - Health check endpoint
âœ… app/api/telemetry/route.ts          - Telemetri endpoint
âœ… TELEMETRY_DOCUMENTATION.md          - DetaylÄ± dokÃ¼mantasyon
âœ… TELEMETRY_QUICKSTART.md             - HÄ±zlÄ± baÅŸlangÄ±Ã§ kÄ±lavuzu
âœ… TELEMETRY_SUMMARY.txt               - Bu dosya (Ã¶zet)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  SONRAKI ADIMLAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. [ ] Dashboard'u baÅŸlat
       ./start.sh

2. [ ] Endpoint'leri test et
       curl https://api.lensia.ai/api/ping
       curl https://api.lensia.ai/api/health

3. [ ] Lensia.ai backend'ine entegre et
       - Ping monitoring ekle
       - Health check logic ekle
       - Alert sistemi kur

4. [ ] Monitoring dashboard oluÅŸtur
       - Grafana/Prometheus
       - veya basit web dashboard

5. [ ] Alert kurallarÄ± tanÄ±mla
       - Telegram/Discord/Slack
       - Email notifications

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“– DetaylÄ± Bilgi:
   - TELEMETRY_DOCUMENTATION.md    (KapsamlÄ± API referansÄ±)
   - TELEMETRY_QUICKSTART.md       (Kod Ã¶rnekleri)
   - API_DOCUMENTATION.md           (Ana API dÃ¶kÃ¼manÄ±)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ Sistem HazÄ±r! Telemetri endpoint'leri kullanÄ±ma hazÄ±r.
